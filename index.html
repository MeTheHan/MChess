<!DOCTYPE html>
<html>
<head>
    <title>MChess - Satranç</title>
    <meta charset="utf-8">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            background: #2c3e50; 
            font-family: Arial; 
            text-align: center; 
            padding: 20px; 
            color: white;
        }
        
        h1 { margin: 20px; font-size: 32px; }
        
        #board {
            width: 400px;
            height: 400px;
            margin: 20px auto;
            border: 3px solid #333;
            display: grid;
            grid-template-columns: repeat(8, 1fr);
        }
        
        .square {
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            cursor: pointer;
        }
        
        .white { background: #f0d9b5; }
        .black { background: #b58863; }
        
        .selected { background: yellow !important; }
        .possible { background: #8f8 !important; }
        
        .controls { margin: 20px; }
        button {
            padding: 10px 20px;
            margin: 5px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover { background: #2980b9; }
        
        #status {
            margin: 20px;
            padding: 10px;
            background: rgba(0,0,0,0.3);
            border-radius: 5px;
            font-size: 18px;
        }
    </style>
</head>
<body>
    <h1>♔ MChess - Satranç</h1>
    <div id="status">Beyaz oynuyor</div>
    <div id="board"></div>
    <div class="controls">
        <button onclick="newGame()">Yeni Oyun</button>
        <button onclick="undo()">Geri Al</button>
        <button onclick="flip()">Çevir</button>
    </div>
    <div id="moves" style="margin:20px;"></div>

<script>
// SATRANÇ MOTORU - Kendi basit motorumuz
class ChessGame {
    constructor() {
        this.board = this.createBoard();
        this.turn = 'white';
        this.selected = null;
        this.history = [];
        this.initPieces();
    }
    
    createBoard() {
        let board = [];
        for(let i=0; i<8; i++) {
            board[i] = new Array(8).fill(null);
        }
        return board;
    }
    
    initPieces() {
        // Beyaz taşlar
        this.board[0] = ['♖','♘','♗','♕','♔','♗','♘','♖'];
        this.board[1] = ['♙','♙','♙','♙','♙','♙','♙','♙'];
        // Siyah taşlar
        this.board[6] = ['♟','♟','♟','♟','♟','♟','♟','♟'];
        this.board[7] = ['♜','♞','♝','♛','♚','♝','♞','♜'];
    }
    
    getPiece(row, col) {
        return this.board[row][col];
    }
    
    move(fromRow, fromCol, toRow, toCol) {
        const piece = this.board[fromRow][fromCol];
        if(!piece) return false;
        
        // Kaydet
        this.history.push({
            from: {row: fromRow, col: fromCol},
            to: {row: toRow, col: toCol},
            piece: piece,
            captured: this.board[toRow][toCol]
        });
        
        // Hareket ettir
        this.board[toRow][toCol] = piece;
        this.board[fromRow][fromCol] = null;
        
        // Sıra değiş
        this.turn = this.turn === 'white' ? 'black' : 'white';
        return true;
    }
    
    undo() {
        if(this.history.length === 0) return false;
        const last = this.history.pop();
        this.board[last.from.row][last.from.col] = last.piece;
        this.board[last.to.row][last.to.col] = last.captured;
        this.turn = this.turn === 'white' ? 'black' : 'white';
        return true;
    }
}

// OYUN DEĞİŞKENLERİ
let game = new ChessGame();
let selected = null;
let boardFlipped = false;

// TAHTAYI OLUŞTUR
function createBoard() {
    const board = document.getElementById('board');
    board.innerHTML = '';
    
    for(let row=0; row<8; row++) {
        for(let col=0; col<8; col++) {
            const square = document.createElement('div');
            const displayRow = boardFlipped ? 7-row : row;
            const displayCol = boardFlipped ? 7-col : col;
            
            square.className = `square ${(row+col)%2===0 ? 'white' : 'black'}`;
            square.dataset.row = displayRow;
            square.dataset.col = displayCol;
            
            const piece = game.getPiece(displayRow, displayCol);
            if(piece) {
                square.textContent = piece;
                square.style.color = piece === piece.toLowerCase() ? 'black' : 'white';
                square.style.textShadow = piece === piece.toLowerCase() 
                    ? '1px 1px 2px white' 
                    : '1px 1px 2px black';
            }
            
            square.onclick = () => handleClick(displayRow, displayCol);
            board.appendChild(square);
        }
    }
    
    updateStatus();
}

// TIKLAMA İŞLEMİ
function handleClick(row, col) {
    const piece = game.getPiece(row, col);
    
    if(selected) {
        // Taşı hareket ettir
        if(game.move(selected.row, selected.col, row, col)) {
            selected = null;
            createBoard();
        } else {
            // Eğer başka taş seçilirse
            if(piece) {
                const isWhite = piece === piece.toUpperCase();
                if((isWhite && game.turn === 'white') || (!isWhite && game.turn === 'black')) {
                    selected = {row, col};
                    highlightSquare(row, col);
                }
            }
        }
    } else {
        // Taş seç
        if(piece) {
            const isWhite = piece === piece.toUpperCase();
            if((isWhite && game.turn === 'white') || (!isWhite && game.turn === 'black')) {
                selected = {row, col};
                highlightSquare(row, col);
            }
        }
    }
}

// KARE VURGULA
function highlightSquare(row, col) {
    document.querySelectorAll('.square').forEach(sq => {
        sq.classList.remove('selected', 'possible');
        if(parseInt(sq.dataset.row) === row && parseInt(sq.dataset.col) === col) {
            sq.classList.add('selected');
        }
    });
}

// DURUM GÜNCELLE
function updateStatus() {
    document.getElementById('status').textContent = 
        `Sıra: ${game.turn === 'white' ? 'Beyaz' : 'Siyah'}`;
    
    // Hamle geçmişi
    let moves = '';
    game.history.forEach((move, i) => {
        const from = String.fromCharCode(97+move.from.col) + (8-move.from.row);
        const to = String.fromCharCode(97+move.to.col) + (8-move.to.row);
        moves += `${i+1}. ${from}→${to} `;
        if((i+1)%3===0) moves += '<br>';
    });
    document.getElementById('moves').innerHTML = moves;
}

// KONTROLLER
function newGame() {
    game = new ChessGame();
    selected = null;
    createBoard();
}

function undo() {
    if(game.undo()) {
        selected = null;
        createBoard();
    }
}

function flip() {
    boardFlipped = !boardFlipped;
    createBoard();
}

// SAYFA YÜKLENİNCE
window.onload = createBoard;
</script>
</body>
</html>
